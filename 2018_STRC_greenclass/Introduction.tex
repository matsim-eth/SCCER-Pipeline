\section{Introduction}

It is increasingly recognized that both the environmental and social costs of travel need to be internalized to meet the demand on already strained transport networks by encouraging shifts in travel patterns.
In this direction, there is a growing body of evidence that informal feedback on energy use can encourage more efficient behavior, both regarding home energy use \citep{faruqui2010impact} and travel behavior \citep{taniguchi2003psychological, fujii2006determinants}.
However, providing feedback on external costs in transport is particularly challenging, due to the heterogeneous nature of the users and privacy constraints.

%%Start here on externalities - Joe, already written
The main externalities of transportation can be divided into two groups: those that affect other road users, namely congestion, and those that affect non-road users such as noise and emissions \citep{button2004rationale}.
The impact of congestion is primarily the loss of time spent waiting in traffic, whereas emissions and noise have both environmental and health consequences.
When people choose to drive on a road, they only have to pay for their private time and car usage costs.
However, they do not have to pay the \textit{marginal social cost} (MSC) of their trip, that is, the additional costs the driver imposes on other drivers by increasing demand on the route.
From economic theory, internalizing this MSC in the form of a tax would reduce congestion and provide an overall social benefit \citep{arnott1994economics, pigou2013economics}.

Microsimulation provides advantages from both the supply (network representation) and demand (individual agents) side when modeling road pricing.
\citet{arnott2001economic} notes that traditional macroscopic models focus on link congestion, while ignoring or simplifying other elements of congestion such as nodal congestion, parking and interactions with pedestrians and spillback.
Microsimulated models allow for the representation of non-homogenous driver behaviour and preferences.
In particular, the importance of value of time heterogenity among individuals in road pricing models has been recognized by numerous researchers \citep{small2001value, verhoef2004product}.
Modern traffic microsimulation frameworks such as MATSim \citep{balmer2009matsim} are able incorporate these various heterogeneities, making them useful for such modeling.

\label{section:kaddoura_congestion_approach}
\citet{kaddoura2015marginal} developed an agent-based marginal-cost pricing approach for congestion, emissions and noise externalities, and applied numerous models successfully to a large-scale scenario of Greater Berlin.
When considering the internalization of congestion costs, a particular contribution of his work was to assign the external congestion costs to the causing agents.
In particular, \citet{kaddoura2015marginal} notes that it is simple to calculate the incurred congestion for each agent, but much more challenging to map it back to the causing agent.
The approach calculates each agent's contribution to the delays on traveled links using a queue-based node-link model including spillback.

In real networks, such an approach requires knowing the location and VTTS of every driver connected to a particular incident of congestion.
This is clearly unrealistic.
Instead, this work presents an approach to impute externalities only using the GPS trace of the trip, a representation of the road network and aggregated congestion values generated from an agent-based MATSim simulation for Switzerland.

\subsection{Swiss MATSim Scenario}
%%Chris or Joe
\label{section:matsim-scenario}
The IVT 2015 Baseline Scenario \citep{bosch2016ivt} represents a typical working day in Switzerland for the year 2015.
As a MATSim scenario, the population consists of individual agents, each with daily travel plans (preferences) and social-demographic characteristics.
These agents represent the entire population of Switzerland on the network from \citet{bosch2015multi}.
The 2015 scenario extends the work of \citet{balmer2006agent} to add households and household incomes and model elements.
The scenario is available in 1\%, 10\% and 100\% samples with respectively increasing runtimes.

\subsection{Analysis of road transport externalities in Switzerland} %%%Swiss norms, ARE report, HBEFA}

Numerous sources are available for the analysis of external costs in Switzerland, including standards, government reports and databases.
These sources guide and inform the evaluation of new and existing infrastructure projects.
A report on the external costs and benefits analysis of transport in Switzerland is available from the \citet{are2016externalcosts}, built on the methodology developed in \citet{ecoplaninfras2014externeeffekte}.
It presents the most recent external cost-benefit analysis for the Swiss transport system, primarily focusing on external environmental, health and accident-related costs.
Specifically, external costs for 12 different cost categories are computed, differentiated according to three different perspectives: transport mode (road/rail/air/water, passenger/freight, vehicle type), transport type (particulary heavy vehicles) and transport user.

For the modeling of road transport pollutant emissions in Switzerland (and other European countries), emission factors are generally taken from the Handbook for Emission Factor Analysis (HBEFA) \citep{maibach2008handbook}.
The HBEFA database contains emission factors for a range of vehicle categories and traffic situations, differentiated by emission type, pollutant and year.
The HBEFA is the standard for road pollutant analysis in Germany, Switzerland and Austria, and is supported by the European Commission.

\citet{foen2010pollutants} use the HBEFA to provide a detailed analysis of past and predicted future pollutant emissions, covering road transport in Switzerland from 1990 to 2035.
Emissions values are calculated for three emissions types: emissions when the engine is in hot operating condition, cold-start emissions and evaporation emissions.
The calculation of these values require both traffic volume data as well as the emissions factors from the HBEFA for each emission type.
The authors model the development of the vehicle fleet composition, vehicle specific mileage and emission standards trends, resulting in traffic volumes (mileage and start/stop processes) differentiated by vehicle category, emission standard and road category.
These traffic volumes are then multiplied by the corresponding emissions factors to obtain the final emissions values.

Concerning congestion specifically, \citet{mkinfras2016staukosten} estimate the external traffic delay costs for the years 2009 to 2014.
The objective of this study was to estimate vehicle hours of delay and identify the contribution from heavy vehicles.
For 2013, this was achieved by combining and aligning INRIX traffic flow data and traffic demand data from the National Passenger Transport Model.
The time lost per road section was calculated by subtracting the free-flow travel time from actual travel time, where traffic jams are considered to occur only when the actual speed is less than 65\% of the free-flow speed.
For the other years, online data from the Federal Roads Office (FEDRO) counting stations was used.
A summary of their results is provided in \Cref{tab:vehHoursDelayMkInfras}.
The values provide a useful estimate of delay costs in Switzerland; however, the use of an "at-least" approach will tend to underestimate the lost time and resulting associated delay costs \citep{mkinfras2016staukosten}.
This is particularly the case for non-motorways road segments, where long road lengths and flawed speed data play a significant role.

\createtable%
{Updated estimated vehicle hours of delay for 2009-2014}%
{Updated estimates of vehicle hours of delay for 2009-2014 and comparison to previously reported values from ARE 2012 for Light (LMV) and Heavy Motorized Vehicles (HMV)}%
{\label{tab:vehHoursDelayMkInfras}}%
{%
  \begin{tabular}[c]{lrrrrrrrr}
    \toprule
    \multirow{3}{*}{} & & \multicolumn{7}{c}{Vehicle hours of delay (Mio/a)}\\ 
    & & \multicolumn{2}{c}{Motorway} & \multicolumn{2}{c}{Non-motorway} & \multicolumn{3}{c}{All roads}\\
    & &  LMV & HMV & LMV & HMV & LMV & HMV & Both\\
    \midrule
    \multirow{6}{*}{Updated}
    & 2009 & 11.41 & 0.53 & 11.23 & 0.22 & 22.64 & 0.75 & 23.39 \\
    & 2010 & 15.19 & 0.79 & 11.23 & 0.22 & 26.42 & 1.00 & 27.42 \\
    & 2011 & 15.68 & 0.81 & 11.23 & 0.22 & 26.90 & 1.03 & 27.93 \\
    & 2012 & 16.45 & 0.85 & 11.23 & 0.22 & 27.68 & 1.07 & 28.75 \\
    & 2013 & 15.67 & 0.82 & 11.23 & 0.22 & 26.90 & 1.04 & 27.93 \\
    & 2014 & 16.62 & 0.87 & 11.23 & 0.22 & 27.85 & 1.09 & 28.94 \\
    \midrule
    Previous & 2009 & 12.40 & 1.08 & 14.10 & 0.28 & 26.5 & 1.4 & 27.9 \\
    \bottomrule
  \end{tabular}
}%
{\citet{mkinfras2016staukosten}, p.141, Annexe A4}

With respect to monetizing externalities, the Swiss Association of Road and Transportation Experts (VSS) has published a series of norms (SN 641 82* : Cost Benefit Analysis for Road Traffic) aimed at guiding the accessment of monetary effects and the cost benefit analysis of transport projects, policies and regulations.
Norms SN 641 820 (Basic Standard), SN 641 822a (Travel Time Costs for Passenger Traffic) and SN 641 828 (External Costs) can be of particular interest in the context of external cost evaluation.
For example, they provide standard values for time costs and willingness to pay per vehicle type and trip purposes as well as standard methods for evaluating the monetary impacts of air pollution and climate impacts.
 

\subsection{Green Class Data}
%%Joe
In the Green Class 2016 pilot project, the SBB created a new mobility offering for subscribers which consisted of a General Abonnenment (GA) travelcard, an electric BMW i3, a park+ride subscription, and car and bike sharing subscriptions.
The 139 participants were tracked for the duration of the project using the "SBB DailyTracks" app enabled with GPS.
The collection process recorded their individual trips and mode of travel.  The fields available for trips and GPS points are repsectively:

\begin{multicols}{2}
\textbf{Trip leg records}
\begin{itemize}
  \item user id
  \item trip leg id
  \item start timestamp
  \item end timestamp
  \item mode of travel
\end{itemize}

\textbf{GPS waypoints:} 
\begin{itemize}
  \item longitude
  \item latitude
  \item timestamp
  \item accuracy (meters)
  \item user id
\end{itemize}

\end{multicols}

For the 139 participants, a total of 163,417 trips were recorded, with an average of 4.5 trip legs per person per day (see \Cref{tab:green_class_gps_summary}).
For this research, the dataset was filtered to only include those trip legs performed either with a personal car or the provided electric vehicle.
For this analysis, only trips starting and ending within Switzerland using either the electric car or personal automobile were selected.

%TODO: \Cref{figure:waypoint_dist} presents the mean number of gps points per trip before and after filtering.

\createtable%
{Green Class Trips and Waypoints}%
{Green Class Trips and Waypoints}%
{\label{tab:green_class_gps_summary}}%
{%
\begin{tabular}{ l | r r | r r r}
                    & \multicolumn{2}{c|}{Full Dataset}  & \multicolumn{3}{c}{Within Switzerland}  \\ 
 
                    & Full Dataset  &   (E)cars & (E)cars   & Cars & E-cars \\ 
\hline
 Users            & \multicolumn{2}{c|}{139} & \multicolumn{3}{c}{139} \\  
 Trips            & 163,417       & 90,568    & 81,365    & 51,843    & 31,219\\  
 Trip Legs        & 301,270     & 100,865   & 90,040    & 57,426    & 32,614\\  
 GPS Points (millions)      &  152.81  &   30.28    &    19.93    & 10.91 & 9.01 \\ 
 GPS Points / Trip Leg &  935.11   &    302.30    &  224.51     &   193.5   &  278.56  \\  
 Trips/person/day & 4.97          & 3.05      & 2.94      & 2.94      & 2.94 \\  
\end{tabular}
}
{}



